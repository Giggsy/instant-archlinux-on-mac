{"name":"Instant-archlinux-on-mac","tagline":"Instant Arch Linux on Mac & MacBook","body":"# Instant Arch Linux on Macs & MacBooks\r\n\r\nThis will setup Arch Linux on your Mac or MacBook all from Mac OSX. No need for any USB drives or figuring out the proper network/video drivers to get your\r\nsystem to get up. It should install without any rebooting etc. Just launch it and enter your password twice and go about your business.\r\n\r\nWarning: Backup your stuff or use a fresh iMac or MacBook. There are no guarantees this will work and it might leave your machine in an unusable \r\nstate. I personally didn't worry about this to much as one can just reset it back to a [factory restore]\r\n(https://github.com/yantis/instant-archlinux-on-mac/blob/master/factory-restore.md) with \"⌘ + R\" at startup \r\nor \"option + ⌘  + R for [internet recovery](https://github.com/yantis/instant-archlinux-on-mac/blob/master/factory-restore.md).\r\n\r\nThat being said. It has been designed to not write anything in case of failure. So worst case if it doesn't work you will probably be OK.\r\nThough seriously back up anything you actually want to be safe.\r\n\r\nWill this work with your iMac or MacBook? Possibly. It worked with all the ones I tested it with. I suspect it will most likely work and even if not perfect\r\nyou will be in a much better place than trying to do it by hand. I do know for a fact that I haven't set it up to work with fusion drives yet\r\nso if your drive is a fusion drive it won't work without some minor changes.\r\n\r\nIf you have any problems feel free to shoot me an email at yantis@yantis.net and we can see if we can solve them together.\r\n\r\n## Tested Working\r\n* Mountain Lion, Lion, Yosemite\r\n* [MacBookPro10,1] - MacBook Pro (Retina, Mid 2012)\r\n* [MacBookPro10,2] - MacBook Pro (Retina, 13-inch, Late 2012)\r\n* [iMac15,1] - iMac Retina 2014\r\n\r\n## Tested not working but in progress\r\n* [MacBook8,1] - MacBook 12\" April 2015 (Setup works but so far no one that I know has any version of Linux on one of these. If you do please let me know so I can fix it)\r\n\r\n# Setup\r\n* Make sure FileVault encryption is [turned off](https://support.apple.com/kb/PH18674?locale=en_US). If it isn't you need to disable it and reboot.\r\n* Use ⌘ + space to open spotlight. Type in terminal and hit return.\r\n* Optionally, update your software either through the terminal or App store  Though if you do you may have to reboot though probably not.\r\nThis step can take a while on a new machine. It usually is a 2+ GB download. You simply might want to use the GUI update application to have some indication of progress.\r\n\r\n```\r\nsudo softwareupdate -i -a\r\n```\r\n\r\nIf you wanted your Mac to have 100GB and Arch Linux to have the rest type this:\r\n\r\n```\r\ncurl -O https://raw.githubusercontent.com/yantis/instant-archlinux-on-mac/master/mac-install.sh && mac-install.sh 100\r\n```\r\n\r\nSame as above but using Google's URL shortener:\r\n\r\n```\r\ncurl -OL goo.gl/VdgxPO && sh VdgxPO 100\r\n```\r\n\r\nThere is a USB option but I haven't figured out the booting on that yet. So that is a work in progress but to \r\ndo that type:\r\n\r\n```\r\ncurl -O https://raw.githubusercontent.com/yantis/instant-archlinux-on-mac/master/mac-install.sh && mac-install.sh USB\r\n```\r\n\r\n# Breakdown (Behind the scenes)\r\n* Command Line Developer tools, Homebrew, VirtualBox, Boot2docker, Docker all get silently and automatically installed.\r\n* Since Mac OSX doesn't support the Ext4 file system. We install a 10 day trial of Paragon ExtFS (It can be uninstalled after the install)\r\n* The file system gets converted to HFS+ if needed then volume gets shrunk down to make room for Arch Linux.\r\n* The physical volume gets mapped to virtual volumes for VirtualBox.\r\n* The system is profiled to be able to dynamically adapt to its hardware.\r\n* Boot2docker launches VirtualBox with our physical volumes mapped.\r\n* A [docker container](https://registry.hub.docker.com/u/yantis/instant-archlinux-on-mac) gets launched which then downloads\r\nthis [script](https://github.com/yantis/instant-archlinux-on-mac/blob/master/mac-install-internal.sh) to dynamically setup Arch Linux.\r\n* It unsquashes a [rootfs image](http://mirror.rackspace.com/archlinux/iso/2015.04.01/arch/x86_64/) into a chroot jail.\r\n* Everything gets installed and setup in that chroot jail.\r\n* Once completed everything in that chroot jail gets rsynced over to the virtual mapped physical drive.\r\n* rEFInd is installed for dual booting Mac OSX & Linux As well as a very sexy [rEFInd Minimal Theme](https://github.com/EvanPurkhiser/rEFInd-minimal)\r\n* Nothing actually gets written unless everything is successful.\r\n\r\n\r\n# Issues\r\n* When booting up there is now a small but noticable delay of around 30 seconds. This has something to do with rEFInd and should be fixable.\r\n\r\n# Troubleshooting\r\n\r\nThe defaults for an HFS+ file system look like this. This script expects your \"Macintosh HD\" to be at disk0s2.\r\n\r\n```\r\n$ diskutil list\r\n\r\n/dev/disk0\r\n#:                       TYPE NAME                    SIZE       IDENTIFIER\r\n0:      GUID_partition_scheme                        *500.3 GB   disk0\r\n1:                        EFI EFI                     209.7 MB   disk0s1\r\n2:                  Apple_HFS Macintosh HD            499.4 GB   disk0s2\r\n3:                 Apple_Boot Recovery HD             650.0 MB   disk0s3\r\n```\r\n\r\nThe defaults for Core Storage look like this. This script expects \"Apple_CoreStorage\" to be at disk0s2.\r\n\r\n```\r\n$ diskutil list\r\n\r\n/dev/disk0\r\n#:                       TYPE NAME                    SIZE       IDENTIFIER\r\n0:      GUID_partition_scheme                        *500.3 GB   disk0\r\n1:                        EFI EFI                     209.7 MB   disk0s1\r\n2:          Apple_CoreStorage                         499.4 GB   disk0s2\r\n3:                 Apple_Boot Recovery HD             650.0 MB   disk0s3\r\n\r\n/dev/disk1\r\n#:                       TYPE NAME                    SIZE       IDENTIFIER\r\n0:                  Apple_HFS Macintosh HD           *499.0 GB   disk1\r\n                              Logical Volume on disk0s2\r\n                              C3E9416F-A8DF-4E50-9BEE-87B2C538689E\r\n                              Unencrypted\r\n```\r\n\r\n* Make sure that FireVault is [turned off](https://support.apple.com/kb/PH18674?locale=en_US)\r\n* If the script doesn't remove Core Storage for you. You can try the trick of enabling FileVault, rebooting, disabling it and rebooting. Which should remove Core Storage.\r\n* Fusion drives do not work yet as it hasn't been programmed in yet.\r\n* Make sure to leave at least 30GB for Mac OSX (or at least whatever the drive space is plus a few GB for updates).\r\n* If you want to mess with a minimal install of Archlinux. It runs perfectly fine on 10GB or less of space.\r\n* This hasn't been tested with bootcamp but I suspect it will not work as is.\r\n\r\n# References & Resources\r\n\r\n#### Mac on Archlinux \r\n* https://wiki.gentoo.org/wiki/Apple_Macbook_Pro_Retina\r\n* http://loicpefferkorn.net/2015/01/arch-linux-on-macbook-pro-retina-2014-with-dm-crypt-lvm-and-suspend-to-disk/\r\n* https://wiki.archlinux.org/index.php/MacBook\r\n* https://bbs.archlinux.org/viewtopic.php?id=195924\r\n* https://github.com/pandeiro/arch-on-air\r\n* https://github.com/jantman/puppet-archlinux-macbookretina\r\n* https://wiki.debian.org/iMacIntel\r\n* https://github.com/coldnew/macbookair-2013-config/blob/master/kernel-config.example\r\n* https://github.com/NapoleonWils0n/cerberus/\r\n* https://github.com/gammy/macbook8-1_archlinux\r\n* https://wiki.archlinux.org/index.php/MacBook\r\n* http://loicpefferkorn.net/2015/01/arch-linux-on-macbook-pro-retina-2014-with-dm-crypt-lvm-and-suspend-to-disk/\r\n* https://medium.com/@PhilPlckthun/arch-linux-running-on-my-macbook-2ea525ebefe3\r\n* https://help.ubuntu.com/community/MacBookPro11-1/utopic\r\n* https://github.com/jantman/puppet-archlinux-macbookretina\r\n* http://www.nixknight.com/2014/02/arch-linux-installation-with-kde-desktop/\r\n* http://codylittlewood.com/arch-linux-on-macbook-pro-installation/\r\n\r\n#### Creating/Resizing of MacOS drives\r\n* http://apple.stackexchange.com/questions/63130/create-new-partition-in-unallocated-space-with-diskutil\r\n* https://github.com/cowboy/dotfiles/blob/master/bin/osx_hide_partition\r\n* http://en.wikipedia.org/wiki/GUID_Partition_Table\r\n\r\n#### Homebrew\r\n* http://brew.sh/\r\n\r\n#### Docker\r\n* http://blog.javabien.net/2014/03/03/setup-docker-on-osx-the-no-brainer-way/\r\n* http://viget.com/extend/how-to-use-docker-on-os-x-the-missing-guide\r\n\r\n#### EXT4\r\n* https://github.com/carlcarl/blog/blob/cacca2e50fe4fbcca2e9c3d68bad9176a66f8016/content/archive/osx_mavericks_ext4.md\r\n* http://download.paragon-software.com/doc/Manual_extfsmac_eng.pdf\r\n* http://www.paragon-software.com/home/extfs-mac/download.html\r\n* https://jamfnation.jamfsoftware.com/discussion.html?id=12843\r\n* http://tips.jay.cat/ext4-support-in-osx-yosemite/\r\n\r\n#### EFI\r\n* http://www.rodsbooks.com/refind/installing.html#wde\r\n\r\n#### VirtualBox\r\n* https://wiki.archlinux.org/index.php/VirtualBox\r\n\r\n#### SquashFS\r\n* http://askubuntu.com/questions/95392/how-to-create-a-bootable-system-with-a-squashfs-root\r\n\r\n[Github Pages](http://yantis.github.io/instant-archlinux-on-mac/)\r\n","google":"UA-61848149-1","note":"Don't delete this file! It's used internally to help with page regeneration."}